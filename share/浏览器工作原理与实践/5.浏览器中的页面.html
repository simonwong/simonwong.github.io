<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器中的页面 | 王思杰的前端笔记</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="分享日常总结，工具框架的使用以及整理">
    <meta http-equiv="cache-control" content="no-cache">
    
    <link rel="preload" href="/assets/css/0.styles.2cd7cfc4.css" as="style"><link rel="preload" href="/assets/js/app.9a5588d9.js" as="script"><link rel="preload" href="/assets/js/2.f5496dfe.js" as="script"><link rel="preload" href="/assets/js/92.10407f98.js" as="script"><link rel="preload" href="/assets/js/3.3b605241.js" as="script"><link rel="prefetch" href="/assets/js/10.2f1b271d.js"><link rel="prefetch" href="/assets/js/100.91a6b97c.js"><link rel="prefetch" href="/assets/js/101.4778598d.js"><link rel="prefetch" href="/assets/js/102.563c7e57.js"><link rel="prefetch" href="/assets/js/103.ce72c4da.js"><link rel="prefetch" href="/assets/js/104.252f4fca.js"><link rel="prefetch" href="/assets/js/105.bf1a4497.js"><link rel="prefetch" href="/assets/js/106.48329b29.js"><link rel="prefetch" href="/assets/js/107.86da97ab.js"><link rel="prefetch" href="/assets/js/108.bf1f7d0b.js"><link rel="prefetch" href="/assets/js/109.fce4393c.js"><link rel="prefetch" href="/assets/js/11.fa3f94d5.js"><link rel="prefetch" href="/assets/js/110.5845d8d8.js"><link rel="prefetch" href="/assets/js/111.012fb9be.js"><link rel="prefetch" href="/assets/js/112.4f0027f8.js"><link rel="prefetch" href="/assets/js/113.d08dbccc.js"><link rel="prefetch" href="/assets/js/114.35e340e3.js"><link rel="prefetch" href="/assets/js/12.1c623331.js"><link rel="prefetch" href="/assets/js/13.7cb5ab29.js"><link rel="prefetch" href="/assets/js/14.5ae7d548.js"><link rel="prefetch" href="/assets/js/15.082b59cb.js"><link rel="prefetch" href="/assets/js/16.ff3a7f3d.js"><link rel="prefetch" href="/assets/js/17.e3d37815.js"><link rel="prefetch" href="/assets/js/18.18e86df5.js"><link rel="prefetch" href="/assets/js/19.b0f29cfe.js"><link rel="prefetch" href="/assets/js/20.2dff0fd3.js"><link rel="prefetch" href="/assets/js/21.a598dfbc.js"><link rel="prefetch" href="/assets/js/22.bdd2af58.js"><link rel="prefetch" href="/assets/js/23.c2657d95.js"><link rel="prefetch" href="/assets/js/24.7a380fd2.js"><link rel="prefetch" href="/assets/js/25.fa48a3a9.js"><link rel="prefetch" href="/assets/js/26.f4e8f16e.js"><link rel="prefetch" href="/assets/js/27.d5b1691f.js"><link rel="prefetch" href="/assets/js/28.9c7fb0e3.js"><link rel="prefetch" href="/assets/js/29.3a633ddf.js"><link rel="prefetch" href="/assets/js/30.ca4c54de.js"><link rel="prefetch" href="/assets/js/31.7c56cbb0.js"><link rel="prefetch" href="/assets/js/32.0405d2af.js"><link rel="prefetch" href="/assets/js/33.c572bd58.js"><link rel="prefetch" href="/assets/js/34.0fd3331f.js"><link rel="prefetch" href="/assets/js/35.24267aa5.js"><link rel="prefetch" href="/assets/js/36.824e5a3c.js"><link rel="prefetch" href="/assets/js/37.22dd536e.js"><link rel="prefetch" href="/assets/js/38.fe9d5b40.js"><link rel="prefetch" href="/assets/js/39.e2decd28.js"><link rel="prefetch" href="/assets/js/4.da6352af.js"><link rel="prefetch" href="/assets/js/40.935d4cfe.js"><link rel="prefetch" href="/assets/js/41.1f1c0c1e.js"><link rel="prefetch" href="/assets/js/42.56cdfbce.js"><link rel="prefetch" href="/assets/js/43.30da5df8.js"><link rel="prefetch" href="/assets/js/44.11e0cc18.js"><link rel="prefetch" href="/assets/js/45.6aba054e.js"><link rel="prefetch" href="/assets/js/46.437e8615.js"><link rel="prefetch" href="/assets/js/47.f694dadf.js"><link rel="prefetch" href="/assets/js/48.aec10a8e.js"><link rel="prefetch" href="/assets/js/49.b814d1fa.js"><link rel="prefetch" href="/assets/js/5.fb05482b.js"><link rel="prefetch" href="/assets/js/50.e93ea0dd.js"><link rel="prefetch" href="/assets/js/51.624e98a2.js"><link rel="prefetch" href="/assets/js/52.163ab829.js"><link rel="prefetch" href="/assets/js/53.fab9cef3.js"><link rel="prefetch" href="/assets/js/54.0d80b286.js"><link rel="prefetch" href="/assets/js/55.f99a79d6.js"><link rel="prefetch" href="/assets/js/56.ca0989a0.js"><link rel="prefetch" href="/assets/js/57.a798a2d6.js"><link rel="prefetch" href="/assets/js/58.4226e5b8.js"><link rel="prefetch" href="/assets/js/59.dffabf60.js"><link rel="prefetch" href="/assets/js/6.de148be3.js"><link rel="prefetch" href="/assets/js/60.a072a5f8.js"><link rel="prefetch" href="/assets/js/61.5f83f024.js"><link rel="prefetch" href="/assets/js/62.c13777f5.js"><link rel="prefetch" href="/assets/js/63.fad1e02f.js"><link rel="prefetch" href="/assets/js/64.38ee8ef5.js"><link rel="prefetch" href="/assets/js/65.7ede8840.js"><link rel="prefetch" href="/assets/js/66.21621800.js"><link rel="prefetch" href="/assets/js/67.e4aef428.js"><link rel="prefetch" href="/assets/js/68.cb293231.js"><link rel="prefetch" href="/assets/js/69.d5045850.js"><link rel="prefetch" href="/assets/js/7.3eb6773c.js"><link rel="prefetch" href="/assets/js/70.513851f8.js"><link rel="prefetch" href="/assets/js/71.8eb1fe47.js"><link rel="prefetch" href="/assets/js/72.63d9d753.js"><link rel="prefetch" href="/assets/js/73.ca3855e0.js"><link rel="prefetch" href="/assets/js/74.c1e15baf.js"><link rel="prefetch" href="/assets/js/75.6208472d.js"><link rel="prefetch" href="/assets/js/76.b93372ca.js"><link rel="prefetch" href="/assets/js/77.2c456706.js"><link rel="prefetch" href="/assets/js/78.7842dad5.js"><link rel="prefetch" href="/assets/js/79.4c5da334.js"><link rel="prefetch" href="/assets/js/8.fd752468.js"><link rel="prefetch" href="/assets/js/80.9b699b8e.js"><link rel="prefetch" href="/assets/js/81.4cacef9d.js"><link rel="prefetch" href="/assets/js/82.2fc03c9a.js"><link rel="prefetch" href="/assets/js/83.a5fe0b60.js"><link rel="prefetch" href="/assets/js/84.9ea63745.js"><link rel="prefetch" href="/assets/js/85.a36858b6.js"><link rel="prefetch" href="/assets/js/86.28be5a47.js"><link rel="prefetch" href="/assets/js/87.dfeace8d.js"><link rel="prefetch" href="/assets/js/88.7831cb4d.js"><link rel="prefetch" href="/assets/js/89.b1d1cfbb.js"><link rel="prefetch" href="/assets/js/9.a3c2b53d.js"><link rel="prefetch" href="/assets/js/90.f372a14c.js"><link rel="prefetch" href="/assets/js/91.059da61e.js"><link rel="prefetch" href="/assets/js/93.2f325957.js"><link rel="prefetch" href="/assets/js/94.d0c63f22.js"><link rel="prefetch" href="/assets/js/95.54f4c5d8.js"><link rel="prefetch" href="/assets/js/96.e60be5d8.js"><link rel="prefetch" href="/assets/js/97.d7c00660.js"><link rel="prefetch" href="/assets/js/98.755e0492.js"><link rel="prefetch" href="/assets/js/99.0e482aad.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2cd7cfc4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">王思杰的前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/" class="nav-link">
  日常笔记
</a></div><div class="nav-item"><a href="/advanced/" class="nav-link">
  前端进阶
</a></div><div class="nav-item"><a href="/backend/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/services/" class="nav-link">
  服务器
</a></div><div class="nav-item"><a href="/computerbasic/" class="nav-link">
  计算机基础
</a></div><div class="nav-item"><a href="/tools/" class="nav-link">
  工具
</a></div><div class="nav-item"><a href="/share/" class="nav-link router-link-active">
  杂乱/分享
</a></div><div class="nav-item"><a href="https://github.com/simonwong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/" class="nav-link">
  日常笔记
</a></div><div class="nav-item"><a href="/advanced/" class="nav-link">
  前端进阶
</a></div><div class="nav-item"><a href="/backend/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/services/" class="nav-link">
  服务器
</a></div><div class="nav-item"><a href="/computerbasic/" class="nav-link">
  计算机基础
</a></div><div class="nav-item"><a href="/tools/" class="nav-link">
  工具
</a></div><div class="nav-item"><a href="/share/" class="nav-link router-link-active">
  杂乱/分享
</a></div><div class="nav-item"><a href="https://github.com/simonwong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/share/" aria-current="page" class="sidebar-link">杂乱/分享</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>重学前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>浏览器工作原理与实践</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/share/浏览器工作原理与实践/1.宏观视角下的浏览器.html" class="sidebar-link">宏观视角下的浏览器</a></li><li><a href="/share/浏览器工作原理与实践/2.浏览器中JS的执行机制.html" class="sidebar-link">浏览器中JS的执行机制</a></li><li><a href="/share/浏览器工作原理与实践/3.v8工作原理.html" class="sidebar-link">V8工作原理</a></li><li><a href="/share/浏览器工作原理与实践/4.浏览器的循环系统.html" class="sidebar-link">浏览器的循环系统</a></li><li><a href="/share/浏览器工作原理与实践/5.浏览器中的页面.html" class="active sidebar-link">浏览器中的页面</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/share/浏览器工作原理与实践/5.浏览器中的页面.html#chrome-开发者工具" class="sidebar-link">Chrome 开发者工具</a></li><li class="sidebar-sub-header"><a href="/share/浏览器工作原理与实践/5.浏览器中的页面.html#dom-树" class="sidebar-link">DOM 树</a></li><li class="sidebar-sub-header"><a href="/share/浏览器工作原理与实践/5.浏览器中的页面.html#渲染流水线" class="sidebar-link">渲染流水线</a></li><li class="sidebar-sub-header"><a href="/share/浏览器工作原理与实践/5.浏览器中的页面.html#分层和合成机制" class="sidebar-link">分层和合成机制</a></li><li class="sidebar-sub-header"><a href="/share/浏览器工作原理与实践/5.浏览器中的页面.html#页面性能" class="sidebar-link">页面性能</a></li><li class="sidebar-sub-header"><a href="/share/浏览器工作原理与实践/5.浏览器中的页面.html#虚拟-dom" class="sidebar-link">虚拟 DOM</a></li><li class="sidebar-sub-header"><a href="/share/浏览器工作原理与实践/5.浏览器中的页面.html#渐进式网页应用-pwa" class="sidebar-link">渐进式网页应用 PWA</a></li><li class="sidebar-sub-header"><a href="/share/浏览器工作原理与实践/5.浏览器中的页面.html#webcomponent" class="sidebar-link">WebComponent</a></li></ul></li><li><a href="/share/浏览器工作原理与实践/6.浏览器中的网络.html" class="sidebar-link">HTTP1</a></li><li><a href="/share/浏览器工作原理与实践/7.浏览器安全.html" class="sidebar-link">浏览器安全</a></li></ul></section></li><li><a href="/share/TypeScript、Rollup搭建工具库.html" class="sidebar-link">TypeScript、Rollup 搭建工具库</a></li><li><a href="/share/从webpack打包看前端模块化.html" class="sidebar-link">从 webpack 打包看前端模块化</a></li><li><a href="/share/ReactFiber架构浅析.html" class="sidebar-link">React Fiber 架构 #</a></li><li><a href="/share/React性能优化方案.html" class="sidebar-link">React性能优化 #</a></li><li><a href="/share/TCP协议.html" class="sidebar-link">TCP协议 #</a></li><li><a href="/share/函数式编程之柯里化.html" class="sidebar-link">函数式编程之柯里化 #</a></li><li><a href="/share/多版本包依赖问题探讨.html" class="sidebar-link">npm多版本包依赖问题探讨</a></li><li><a href="/share/常见的函数组合.html" class="sidebar-link">常见的函数组合</a></li><li><a href="/share/算法分享递归到树到动态规划.html" class="sidebar-link">算法分享</a></li><li><a href="/share/纯函数.html" class="sidebar-link">纯函数 #</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="浏览器中的页面"><a href="#浏览器中的页面" class="header-anchor">#</a> 浏览器中的页面</h1> <h2 id="chrome-开发者工具"><a href="#chrome-开发者工具" class="header-anchor">#</a> Chrome 开发者工具</h2> <table><thead><tr><th>名称</th> <th>描述</th></tr></thead> <tbody><tr><td>Elements</td> <td>可以查看DOM结构、编辑CSS样式,用于测试页面布局和设计页面。</td></tr> <tr><td>Console</td> <td>可以看成是 javascript Shell,能执行 Javascript脚本。通过 Console还能和页面中的 javascript对象交互。</td></tr> <tr><td>Source</td> <td>1. 查看Wcb应用加载的所有文件<br>2. 编辑CSS和 Javascript文件内容<br>3. 将打乱的CSS文件或者 Javascript文件格式化;<br>4. 支持 Javascript的调试功能<br>5. 设置工作区,将更改的文件保存到本地文件夹中。</td></tr> <tr><td>NetWork</td> <td>展示了页面中所有的请求内容列表、能查看每项请求的请求行、请求头、请求体、时间线以及网络请求瀑布图等信息。</td></tr> <tr><td>Performance</td> <td>记录和查看Wcb应用生命周期内的各种事件,并用来分析在执行过程中一些影响性能的要点。</td></tr> <tr><td>Memory</td> <td>用来查看运行过程中的 Javascript 占用堆内存情况,追踪是否存在内存泄的情况等。</td></tr> <tr><td>Application</td> <td>查看Wcb应用的数据存储情况<br>PWA的基础数据; Indexeddb; Web SQL;本地和会话存储: Cookie;应用程序缓存;图像;字体和样式表等。</td></tr> <tr><td>Security</td> <td>显示当前页面一些基础的安全信息。</td></tr> <tr><td>Audits</td> <td>会对当前网页进行网络利用情况、网页性能方面的诊断,并给出一些优化建议。</td></tr> <tr><td>Layers</td> <td>展示一些渲染过程中分层的基础信息。</td></tr></tbody></table> <h3 id="network"><a href="#network" class="header-anchor">#</a> NetWork</h3> <p><img src="http://file.wangsijie.top/blog/20210618141751.png" alt=""></p> <h2 id="dom-树"><a href="#dom-树" class="header-anchor">#</a> DOM 树</h2> <p>在渲染引擎内部，有一个叫**HTML解析器（HTMLParser）**的模块，负责将HTML字节流转换为DOM结构。</p> <p>HTML 文档边加载边解析。</p> <p><strong>碰到 script 标签时，会先去执行 js ，js 文件下载也会阻塞 DOM 的解析。</strong></p> <p>script <code>async</code> 下载完后会立即执行，<code>defer</code> 会在文档解析后，<code>DOMContentLoaded</code> 前执行，所以会阻塞 <code>DOMContentLoaded</code></p> <p>样式文件会阻塞 css 文件。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> div1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    div1<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">'time.geekbang'</span>

    <span class="token keyword">let</span> div2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    div2<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">'time.geekbang.com'</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="渲染流水线"><a href="#渲染流水线" class="header-anchor">#</a> 渲染流水线</h2> <p><img src="http://file.wangsijie.top/blog/20210618161044.png" alt=""></p> <p>通常情况下的瓶颈主要体现在<strong>下载CSS文件、下载JavaScript文件和执行JavaScript</strong></p> <p>优化策略</p> <ul><li>通过内联JavaScript、内联CSS来移除这两种类型的文件下载，这样获取到HTML文件之后就可以直接开始渲染流程了。</li> <li>但并不是所有的场合都适合内联，那么还可以尽量减少文件大小，比如通过webpack等工具移除一些不必要的注释，并压缩JavaScript文件。</li> <li>还可以将一些不需要在解析HTML阶段使用的JavaScript标记上async或者defer。</li> <li>对于大的CSS文件，可以通过媒体查询属性，将其拆分为多个不同用途的CSS文件，这样只有在特定的场景下才会加载特定的CSS文件。</li></ul> <h2 id="分层和合成机制"><a href="#分层和合成机制" class="header-anchor">#</a> 分层和合成机制</h2> <h2 id="页面性能"><a href="#页面性能" class="header-anchor">#</a> 页面性能</h2> <h3 id="加载阶段"><a href="#加载阶段" class="header-anchor">#</a> 加载阶段</h3> <p><img src="http://file.wangsijie.top/blog/20210621095343.jpg" alt=""></p> <p><strong>总的优化原则就是减少关键资源个数，降低关键资源大小，降低关键资源的RTT次数</strong>。</p> <h3 id="交互阶段"><a href="#交互阶段" class="header-anchor">#</a> 交互阶段</h3> <ol><li><p>减少 JS 执行时间</p></li> <li><p>避免强制同步布局</p> <p>由于要获取到offsetHeight，但是此时的offsetHeight还是老的数据，所以需要立即执行布局操作</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> main_div<span class="token punctuation">,</span> new_node <span class="token comment">// 省略........</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;mian_div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>new_node<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>main_div<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <p>改成如下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> main_div <span class="token comment">// 省略........</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>main_div<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">)</span>  
    <span class="token keyword">let</span> new_node <span class="token comment">// 省略........ </span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;mian_div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>new_node<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li><p>避免布局抖动</p> <p>指在一次JavaScript执行过程中，多次执行强制布局和抖动操作</p></li> <li><p>合理利用 CSS 合成动画，能让 css 处理动画尽量让 css 处理</p></li> <li><p>避免频繁的垃圾回收</p></li></ol> <h2 id="虚拟-dom"><a href="#虚拟-dom" class="header-anchor">#</a> 虚拟 DOM</h2> <h3 id="dom-的缺陷"><a href="#dom-的缺陷" class="header-anchor">#</a> DOM 的缺陷</h3> <p>利用类似 <code>document.body.appendChild(node)</code> 会触发重排。
不当的 DOM 操作还会引起强制同步布局和布局抖动。</p> <h3 id="虚拟-dom-2"><a href="#虚拟-dom-2" class="header-anchor">#</a> 虚拟 DOM</h3> <ol><li><p>双缓存</p> <p>将计算的中间结果放到一个缓冲区，等全部计算完后一次性复制到显示缓冲区</p></li> <li><p>MVC 模式</p> <p><img src="http://file.wangsijie.top/blog/20210621102719.png" alt=""></p></li></ol> <h2 id="渐进式网页应用-pwa"><a href="#渐进式网页应用-pwa" class="header-anchor">#</a> 渐进式网页应用 PWA</h2> <p>Progressive Web App， 字面意思就是“渐进式 + web应用”</p> <p><strong>渐进式增强Web的优势，并通过技术手段渐进式缩短和本地应用或者小程序的距离</strong></p> <h3 id="web-应用-vs-本地应用"><a href="#web-应用-vs-本地应用" class="header-anchor">#</a> web 应用 vs 本地应用</h3> <ul><li>web 应用缺少离线使用能力，离线或弱网几乎无法使用</li> <li>web 应用缺少消息推送能力</li> <li>web 应用缺少一级入口</li></ul> <p>PWA 提供了两种解决方案</p> <ul><li>引入 service worker 解决离线和推送问题</li> <li>引入 mainfest.json 解决一级入口问题</li></ul> <h3 id="service-worker"><a href="#service-worker" class="header-anchor">#</a> Service Worker</h3> <p>主要思想是<strong>在页面和网络之间增加一个拦截器，用来缓存和拦截请求</strong></p> <p><img src="http://file.wangsijie.top/blog/20210621103739.png" alt=""></p> <ul><li>架构：Service Worker是运行在浏览器进程中的</li> <li>消息推送：也是基于Service Worker来实现的</li> <li>安全：要使站点支持Service Worker，首先必要的一步就是要将站点升级到HTTPS</li></ul> <h2 id="webcomponent"><a href="#webcomponent" class="header-anchor">#</a> WebComponent</h2> <p>WebComponent是一套技术的组合，具体涉及到了**Custom elements（自定义元素）、Shadow DOM（影子DOM）*<em>和*<em>HTML templates（HTML模板）</em></em></p> <ol><li>查找模板内容；</li> <li>创建影子DOM；</li> <li>再将模板添加到影子DOM上。</li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">25 天前</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/share/浏览器工作原理与实践/4.浏览器的循环系统.html" class="prev">
        浏览器的循环系统
      </a></span> <span class="next"><a href="/share/浏览器工作原理与实践/6.浏览器中的网络.html">
        HTTP1
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.9a5588d9.js" defer></script><script src="/assets/js/2.f5496dfe.js" defer></script><script src="/assets/js/92.10407f98.js" defer></script><script src="/assets/js/3.3b605241.js" defer></script>
  </body>
</html>
