<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">çŠ¶æ€æ›´æ–° | ç‹æ€æ°çš„æŠ€æœ¯ç¬”è®°</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://simonwong.github.io//docs/advanced/react-deep/state-change"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="çŠ¶æ€æ›´æ–° | ç‹æ€æ°çš„æŠ€æœ¯ç¬”è®°"><meta data-react-helmet="true" name="description" content="æ›´æ–°ä¼˜å…ˆçº§"><meta data-react-helmet="true" property="og:description" content="æ›´æ–°ä¼˜å…ˆçº§"><link data-react-helmet="true" rel="icon" href="/img/logo.png"><link data-react-helmet="true" rel="canonical" href="https://simonwong.github.io//docs/advanced/react-deep/state-change"><link data-react-helmet="true" rel="alternate" href="https://simonwong.github.io//docs/advanced/react-deep/state-change" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://simonwong.github.io//docs/advanced/react-deep/state-change" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.16564702.css">
<link rel="preload" href="/assets/js/runtime~main.c6785169.js" as="script">
<link rel="preload" href="/assets/js/main.608fd00c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ETHw">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_Z3RH"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="logo" class="themedImage_P01U themedImage--light_MhUT"><img src="/img/logo.png" alt="logo" class="themedImage_P01U themedImage--dark_DGdQ"></div><b class="navbar__title">ç‹æ€æ°çš„æŠ€æœ¯ç¬”è®°</b></a><a class="navbar__item navbar__link" href="/docs/note">æ—¥å¸¸ç¬”è®°</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/advanced">å‰ç«¯è¿›é˜¶</a><a class="navbar__item navbar__link" href="/docs/backend">åç«¯</a><a class="navbar__item navbar__link" href="/docs/services">æœåŠ¡å™¨</a><a class="navbar__item navbar__link" href="/docs/computerbasic">è®¡ç®—æœºåŸºç¡€</a><a class="navbar__item navbar__link" href="/docs/tools">å·¥å…·</a><a class="navbar__item navbar__link" href="/docs/share">åˆ†äº«</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/simonwong" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_tkav toggle_o187 toggleDisabled_wOyS"><div class="toggleTrack_pcAh" role="button" tabindex="-1"><div class="toggleTrackCheck_JsCu"><span class="toggleIcon_MHzn">ğŸŒœ</span></div><div class="toggleTrackX_bGgm"><span class="toggleIcon_MHzn">ğŸŒ</span></div><div class="toggleTrackThumb_ReJx"></div></div><input type="checkbox" class="toggleScreenReader_HXme" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_Ot41"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_C83L" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer__x9s"><div class="sidebar_rFvA sidebarWithHideableNavbar_J9Xr"><a tabindex="-1" class="sidebarLogo_bwjY" href="/"><img src="/img/logo.png" alt="logo" class="themedImage_P01U themedImage--light_MhUT"><img src="/img/logo.png" alt="logo" class="themedImage_P01U themedImage--dark_DGdQ"><b>ç‹æ€æ°çš„æŠ€æœ¯ç¬”è®°</b></a><nav class="menu thin-scrollbar menu_LqJT"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/advanced">å‰ç«¯è¿›é˜¶</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_wkfl" href="/docs/advanced/react-practice/æœ€ä½³å®è·µ">React å®è·µ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_wkfl" aria-current="page" href="/docs/advanced/react-deep/">æ·±å…¥ React ç³»åˆ—</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/react-deep/">æ·±å…¥å­¦ä¹  React</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/react-deep/fiber">Fiber çš„ç›¸å…³æ¦‚å¿µ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/react-deep/react-glossary">React è¯æ±‡è¡¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/react-deep/react-18-feature">React 18 çš„æ–°ç‰¹æ€§</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/react-deep/stage-render">render æµç¨‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/react-deep/stage-commit">commit é˜¶æ®µ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/react-deep/react-fake">React æµç¨‹ä¼ªç </a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/react-deep/lane-model">lane æ¨¡å‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/react-deep/diff">React diff ç®—æ³•</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/advanced/react-deep/state-change">çŠ¶æ€æ›´æ–°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/react-deep/scheduler">React è°ƒåº¦å™¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/react-deep/synthetic-event">React åˆæˆäº‹ä»¶</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_wkfl" href="/docs/advanced/react-ecology/">æ·±å…¥ React ç”Ÿæ€ç³»åˆ—</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_wkfl" href="/docs/advanced/rollup/">Rollup</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_wkfl" href="/docs/advanced/webpack/">Webpack</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/advanced/æ„å»ºè„šæ‰‹æ¶">æ„å»ºè„šæ‰‹æ¶</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_aZTw"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_P3pt"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_IkDd"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_cTXg"><div class="docItemContainer_NJQc"><article><div class="tocCollapsible_b03x theme-doc-toc-mobile tocMobile_GmwT"><button type="button" class="clean-btn tocCollapsibleButton_kOOX">On this page</button></div><div class="theme-doc-markdown markdown"><h1>çŠ¶æ€æ›´æ–°</h1><h2 class="anchor anchorWithHideOnScrollNavbar_pHHM" id="æ›´æ–°ä¼˜å…ˆçº§">æ›´æ–°ä¼˜å…ˆçº§<a class="hash-link" href="#æ›´æ–°ä¼˜å…ˆçº§" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_pHHM" id="updatequeue">UpdateQueue<a class="hash-link" href="#updatequeue" title="Direct link to heading">â€‹</a></h3><p>å°±åƒ fibers ä¸€æ ·ï¼ˆåŒç¼“å­˜æŠ€æœ¯ double buffering ï¼Œä¸€ä¸ª current treeï¼Œä¸€ä¸ª workInProgress treeï¼‰ï¼Œæ›´æ–°é˜Ÿåˆ—ä¹Ÿæ˜¯æˆå¯¹å‡ºç°çš„ã€‚</p><p>ä¸€ä¸ªå½“å‰è¡¨ç¤ºå±å¹•å¯è§çŠ¶æ€çš„é˜Ÿåˆ—ï¼ˆcurrent queueï¼‰ï¼Œä¸€ä¸ªå¯ä»¥æŒ‚åœ¨ï¼ˆmutatedï¼‰å¯ä»¥åœ¨ committed å‰å¼‚æ­¥å¤„ç†çš„ work-in-progress é˜Ÿåˆ—ï¼ˆwork-in-progress queue, æˆ‘ä»¬ç®€ç§° WIP queueï¼‰ã€‚</p><p>å¦‚æœä¸€ä¸ª WIP æ¸²æŸ“åœ¨å®Œæˆå‰è¢«ä¸¢å¼ƒï¼Œæˆ‘ä»¬å¯ä»¥ä» current queue å…‹éš†ä¸€ä¸ªæ–°çš„ WIP queueã€‚</p><p>ä¸¤ä¸ªé˜Ÿåˆ—å…±äº«ä¸€ä¸ªæŒä¹…çš„å•é“¾è¡¨ç»“æ„ï¼Œä¸ºäº†è°ƒåº¦æ›´æ–°ï¼Œæˆ‘ä»¬æŠŠå®ƒæ·»åŠ åˆ°ä¸¤ä¸ªé˜Ÿåˆ—åé¢ã€‚æ¯ä¸ªé˜Ÿåˆ—éƒ½ç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æŒä¹…åˆ—è¡¨ä¸­å°šæœªå¤„ç†çš„ç¬¬ä¸€æ¬¡æ›´æ–°ã€‚WIP queue çš„æŒ‡é’ˆæ€»æ˜¯æœ‰ä¸€ä¸ªä½ç½®æŒ‡å‘ç­‰äºæˆ–å¤§äºå½“å‰é˜Ÿåˆ—ï¼Œå› ä¸ºæˆ‘ä»¬æ€»æ˜¯å¤„ç†è¯¥é˜Ÿåˆ—ã€‚</p><p>current queue çš„æŒ‡é’ˆä»…åœ¨ commit é˜¶æ®µï¼ˆä» current queue swapï¼‰æ›´æ–°ã€‚</p><div class="codeBlockContainer_g4TC language-toml theme-code-block"><div class="codeBlockContent_bedI toml"><pre tabindex="0" class="prism-code language-toml codeBlock_NdwV thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_NSQt"><span class="token-line" style="color:#393A34"><span class="token plain">current æŒ‡é’ˆ:           A - B - C - D - E - F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WIP æŒ‡é’ˆ:                           D - E - F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                   ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WIP queue å¤„ç†çš„æ›´æ–°æ¯” current å¤š</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_crNb clean-btn">Copy</button></div></div><p>æˆ‘ä»¬æ·»åŠ ä¸¤ä¸ªé˜Ÿåˆ—æ˜¯å› ä¸ºæˆ‘ä»¬å¯èƒ½åœ¨åˆ é™¤æ›´æ–°è€Œä¸è¿›è¡Œä»»ä½•å¤„ç†ã€‚æ¯”å¦‚ï¼Œå¦‚æœæˆ‘ä»¬ä»…ä»…å‘ WIP queue æ›´æ–°ï¼Œä¸€äº›æ›´æ–°å¯èƒ½ä¼šä¸¢å¤±ï¼Œæ¯å½“ WIP é€šè¿‡ä» current å…‹éš†æ¥é‡å¯æ¸²æŸ“ã€‚ç±»ä¼¼çš„ï¼Œå¦‚æœæˆ‘ä»¬åªå‘ current tree æ·»åŠ æ›´æ–°ï¼Œé‚£ä¹ˆæ¯å½“ WIP queu æäº¤å¹¶å’Œå½“å‰é˜Ÿåˆ—äº¤æ¢æ—¶ï¼Œæ›´æ–°å°±ä¼šä¸¢å¤±ã€‚</p><p>é€šè¿‡å‘ä¸¤ä¸ªé˜Ÿåˆ—æ·»åŠ ï¼Œæˆ‘ä»¬å¯ä»¥ä¿è¯æ›´æ–°å°†æˆä¸ºä¸‹ä¸€ä¸ª WIPï¼ˆè€Œä¸” WIP queue ä¸€æ—¦ commitï¼Œå˜æˆä¸º current queueï¼Œä»–ä»¬ä¸ä¼šæœ‰ä¸¤æ¬¡ç›¸åŒçš„æ›´æ–°å±é™©ï¼‰</p><h3 class="anchor anchorWithHideOnScrollNavbar_pHHM" id="ä¼˜å…ˆé¡ºåºprioritization">ä¼˜å…ˆé¡ºåºï¼ˆPrioritizationï¼‰<a class="hash-link" href="#ä¼˜å…ˆé¡ºåºprioritization" title="Direct link to heading">â€‹</a></h3><p>æ›´æ–°ä¸æ€»æ˜¯æŒ‰ä¼˜å…ˆçº§æ’åºï¼Œè€Œæ˜¯æŒ‰æ’å…¥çš„ï¼Œæ–°çš„æ›´æ–°æ€»æ˜¯æ·»åŠ åœ¨é˜Ÿå°¾ã€‚</p><p>ä¸è¿‡è¿™ä¸ªä¼˜å…ˆçº§ä»ç„¶æ˜¯é‡è¦çš„ï¼Œåœ¨ render é˜¶æ®µå¤„ç†æ›´æ–°é˜Ÿåˆ—æ—¶ï¼Œç»“æœä¸­åªåŒ…å«å…·æœ‰è¶³å¤Ÿä¼˜å…ˆçº§çš„æ›´æ–°ã€‚</p><p>å¦‚æœæˆ‘ä»¬å› ä¸ºæ²¡æœ‰è¶³å¤Ÿä¼˜å…ˆçº§è€Œè·³è¿‡ä¸€ä¸ªæ›´æ–°ï¼Œå®ƒå°†ä¿ç•™åœ¨é˜Ÿåˆ—ä¸­ä»¥ç¨ååœ¨ä½ä¼˜å…ˆçº§æœŸé—´å¤„ç†ã€‚</p><p>è‡³å…³é‡è¦çš„æ˜¯ï¼Œè·³è¿‡çš„æ›´æ–°ä¹‹åçš„æ‰€æœ‰æ›´æ–°ä¹Ÿä¼šä¿ç•™åœ¨é˜Ÿåˆ—ä¸­ï¼ˆä¸ç®¡å®ƒä»¬çš„ä¼˜å…ˆçº§å¦‚ä½•ï¼‰ï¼Œè¿™æ„å‘³ç€é«˜ä¼˜å…ˆçº§æ›´æ–°æœ‰æ—¶ä¼šä»¥ä¸¤ç§ä¸åŒçš„ä¼˜å…ˆçº§å¤„ç†ä¸¤æ¬¡ã€‚æˆ‘ä»¬è¿˜ä¿æŒè·Ÿè¸ªä¸€ä¸ªåŸºæœ¬çŠ¶æ€ï¼Œä»–è¡¨ç¤ºåº”ç”¨é˜Ÿåˆ—ä¸­ç¬¬ä¸€æ¬¡æ›´æ–°ä¹‹å‰çš„çŠ¶æ€ã€‚</p><p><img src="http://file.wangsijie.top/blog/202201241722787.png"></p><p>å›¾ç‰‡è‡ªåˆ¶ï¼Œå†…å®¹æ¥è‡ª <a href="https://twitter.com/acdlite/status/978412930973687808" target="_blank" rel="noopener noreferrer">Andrew Clark: ä¸åŒä¼˜å…ˆçº§æµç¨‹ (in Twitter)</a></p><p>ä¸¾ä¸ªä¾‹å­:</p><p>ç»™å®šå½“å‰çŠ¶æ€ä¸º<code> &#x27;&#x27;</code>, ä»¥åŠä¸‹é¢çš„æ›´æ–°é˜Ÿåˆ—</p><p>  <code>A1 - B2 - C1 - D2</code></p><p>å…¶ä¸­æ•°å­—è¡¨ç¤ºä¼˜å…ˆçº§ï¼Œæ’å…¥å­—ç¬¦ä¸²ä»¥æ›´æ–°çŠ¶æ€, <em>React</em> å°†ä¼šä»¥ä¸¤ä¸ªå•ç‹¬çš„æ¸²æŸ“å¤„ç†è¿™äº›æ›´æ–°ï¼Œæ¯ä¸ªä¸åŒçš„ä¼˜å…ˆçº§ä¸€ä¸ªï¼š</p><ol><li><p>ç¬¬ä¸€æ¬¡æ¸²æŸ“ï¼Œä¼˜å…ˆçº§ä¸º1ï¼š</p><p>åˆå§‹çŠ¶æ€: <code>&#x27;&#x27;</code></p><p>æ›´æ–°é˜Ÿåˆ—: <code>[A1, C1]</code></p><p>çŠ¶æ€ç»“æœ: <code>&#x27;AC&#x27;</code></p></li><li><p>ç¬¬äºŒæ¬¡æ¸²æŸ“ï¼Œä¼˜å…ˆçº§ä¸º1ï¼š</p><p>åˆå§‹çŠ¶æ€: <code>&#x27;A&#x27;</code>ï¼ˆåˆå§‹çŠ¶æ€ä¸åŒ…å« C1ï¼Œå› ä¸º B2 è¢«è·³è¿‡äº†ï¼‰</p><p>æ›´æ–°é˜Ÿåˆ—: <code>[B2, C1ï¼Œ D2]</code> ï¼ˆC1 rebase åœ¨ B2 åé¢ï¼‰</p><p>çŠ¶æ€ç»“æœ: <code>&#x27;ABCD&#x27;</code></p></li></ol><p>å› ä¸ºæˆ‘ä»¬æ˜¯æŒ‰æ’å…¥é¡ºåºå¤„ç†æ›´æ–°çš„ï¼Œå¹¶åœ¨è·³è¿‡ä¹‹å‰çš„æ›´æ–°æ—¶ rebase é«˜ä¼˜å…ˆçº§çš„æ›´æ–°ï¼Œæ‰€ä»¥<strong>ä¸è®ºä¼˜å…ˆçº§å¦‚ä½•ï¼Œæœ€ç»ˆç»“æœæ˜¯ç¡®å®š</strong>ã€‚</p><p>ä¸­é—´çŠ¶æ€å¯èƒ½å› ä¸ºä¸ç”¨ä¼˜å…ˆçº§è€Œæœ‰æ‰€ä¸åŒï¼Œä½†æ˜¯æœ€ç»ˆç»“æœæ˜¯ç›¸åŒçš„ã€‚</p><p>å‚è€ƒ <a href="https://github.com/facebook/react/blob/main/packages/react-reconciler/src/ReactUpdateQueue.new.js" target="_blank" rel="noopener noreferrer">React Reconciler ReactUpdateQueue.new.js</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_pHHM" id="æ•°æ®ç»“æ„">æ•°æ®ç»“æ„<a class="hash-link" href="#æ•°æ®ç»“æ„" title="Direct link to heading">â€‹</a></h2><p>æˆ‘ä»¬åœ¨çŠ¶æ€æ›´æ–°æ—¶é¦–å…ˆä¼šåˆ›å»ºä¸€ä¸ª <code>Update</code> å¯¹è±¡ï¼Œè¡¨ç¤ºçŠ¶æ€çš„æ›´æ–°ã€‚</p><p>ç”±äºä¸åŒç±»å‹ç»„ä»¶å·¥ä½œæ–¹å¼ä¸åŒï¼Œæ‰€ä»¥å­˜åœ¨ä¸¤ç§ä¸åŒç»“æ„çš„<code>Update</code>ï¼Œå…¶ä¸­<code>ClassComponent</code>ä¸<code>HostRoot</code>å…±ç”¨ä¸€å¥—<code>Update</code>ç»“æ„ï¼Œ<code>FunctionComponent</code>å•ç‹¬ä½¿ç”¨ä¸€ç§<code>Update</code>ç»“æ„ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_pHHM" id="classcomponent--hostroot">ClassComponent / HostRoot<a class="hash-link" href="#classcomponent--hostroot" title="Direct link to heading">â€‹</a></h2><p>ç±»ç»„ä»¶ï¼Œæˆ–è€…æ ¹ç»„ä»¶</p><p>æ ¹ç»„ä»¶ä¼šåœ¨ <code>updateContainer</code> ä¸­è°ƒç”¨ <code>createUpdate</code> <code>enqueueUpdate</code></p><p>ç±»ç»„ä»¶ <code>this.setState(xxx)</code> ä¼šè°ƒç”¨   <code>enqueueSetState</code> ï¼Œç„¶åè°ƒç”¨ <code>createUpdate</code> <code>enqueueUpdate</code></p><h3 class="anchor anchorWithHideOnScrollNavbar_pHHM" id="createupdate">createUpdate<a class="hash-link" href="#createupdate" title="Direct link to heading">â€‹</a></h3><p>createUpdate ä¼šåˆ›å»ºå¹¶è¿”å›å¦‚ä¸‹ç»“æ„çš„ Update å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„</p><div class="codeBlockContainer_g4TC language-typescript theme-code-block"><div class="codeBlockContent_bedI typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_NdwV thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_NSQt"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">Update</span><span class="token class-name operator" style="color:#393A34">&lt;</span><span class="token class-name maybe-class-name">State</span><span class="token class-name operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  eventTime</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ä»»åŠ¡æ—¶é—´ï¼Œé€šè¿‡ performance.now() è·å–çš„æ¯«ç§’æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  lane</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Lane</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ä¼˜å…ˆçº§ï¼Œå½“å‰æ›´æ–°èƒ½å¦è¢«å¤„ç†å–å†³äºä»–çš„ä¼˜å…ˆçº§æ˜¯å¦åœ¨æœ¬æ¬¡æ¸²æŸ“çš„æ‰¹æ¬¡ä¸­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tag</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// æ›´æ–°ç±»å‹ï¼Œåˆ†åˆ«å¯¹åº” UpdateState ReplaceState ForceUpdate CaptureUpdate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  payload</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// æºå¸¦çš„çŠ¶æ€ï¼Œclass ä¸­æ˜¯å¯¹è±¡æˆ–è€…å‡½æ•° (prevState, nextProps) =&gt; newStateï¼›root ä¸­æ˜¯ rootEl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  callback</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> mixed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// å›è°ƒå‡½æ•°ï¼Œä¼šåœ¨ commit#layout é˜¶æ®µè§¦å‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  next</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Update</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">State</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ä¸‹ä¸€ä¸ª Update</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_crNb clean-btn">Copy</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_pHHM" id="enqueueupdate">enqueueUpdate<a class="hash-link" href="#enqueueupdate" title="Direct link to heading">â€‹</a></h3><p>åœ¨ fiber èŠ‚ç‚¹ä¸Šæœ‰ä¸€ä¸ª updateQueue å±æ€§ï¼Œå®ƒæ˜¯ä¸‹é¢è¿™æ ·çš„ä¸€ä¸ª UpdateQueue å¯¹è±¡ã€‚</p><div class="codeBlockContainer_g4TC language-typescript theme-code-block"><div class="codeBlockContent_bedI typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_NdwV thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_NSQt"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">SharedQueue</span><span class="token class-name operator" style="color:#393A34">&lt;</span><span class="token class-name maybe-class-name">State</span><span class="token class-name operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pending</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Update</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">State</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  interleaved</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Update</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">State</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  lanes</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Lanes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// current è¡¨ç¤ºå·²ç»æ›´æ–°ä¸Šå»çš„çŠ¶æ€ / ä¸Šä¸€æ¬¡æ›´æ–°ä¸Šå»çš„çŠ¶æ€ï¼Œå¦‚ä¸Šé¢ä¾‹å­ä¸­çš„ç¬¬ä¸€æ¸²æŸ“åçš„ç»“æœã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">UpdateQueue</span><span class="token class-name operator" style="color:#393A34">&lt;</span><span class="token class-name maybe-class-name">State</span><span class="token class-name operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  baseState</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">State</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// current Fiber çš„ state (old state) ä»¥ä»–ä¸ºåŸºç¡€ï¼Œå¦‚ä¾‹å­ä¸­çš„ç¬¬äºŒæ¬¡æ¸²æŸ“çš„åˆå§‹çŠ¶æ€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  firstBaseUpdate</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Update</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">State</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// current ä¸Š Update å¤´èŠ‚ç‚¹ï¼Œå¦‚ä¾‹å­ä¸­çš„ç¬¬äºŒæ¬¡æ¸²æŸ“çš„ B2-C1-D2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  lastBaseUpdate</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Update</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">State</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// current ä¸Š Update å°¾èŠ‚ç‚¹ï¼ŒB2 æ˜¯ first , D2 æ˜¯ last</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  shared</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">SharedQueue</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">State</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// å­˜å‚¨ç€æœ¬æ¬¡æ›´æ–°çš„ update é˜Ÿåˆ—ï¼Œæ˜¯å®é™…çš„ updateQueueã€‚shared çš„æ„æ€æ˜¯ current èŠ‚ç‚¹ä¸ workInProgress èŠ‚ç‚¹å…±äº«ä¸€æ¡æ›´æ–°é˜Ÿåˆ—ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  effects</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Update</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">State</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ä¿å­˜ update.callback !== null çš„ Update</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_crNb clean-btn">Copy</button></div></div><p>enqueueUpdate ä¼šä½¿å¾— UpdateQueue ï¼ˆå®é™…ä¸Šæ˜¯å®ƒä¸Šé¢çš„ shared.pendingï¼‰å½¢æˆä¸€ä¸ªå•å‘ç¯å½¢é“¾è¡¨ç»“æ„ã€‚</p><div class="codeBlockContainer_g4TC language-js theme-code-block"><div class="codeBlockContent_bedI js"><pre tabindex="0" class="prism-code language-js codeBlock_NdwV thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_NSQt"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">enqueueUpdate</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">fiberï¼Œ updateï¼Œ lane</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> updateQueue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fiber</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">updateQueue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> sharedQueue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> updateQueue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">shared</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> pending </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sharedQueue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pending</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// pending æ€»æ˜¯æŒ‡å‘æœ€åä¸€ä¸ª Updateï¼Œpending.next å°±æ˜¯ head</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pending </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    update</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">next</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> update</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    update</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">next</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pending</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">next</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pending</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">next</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> update</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sharedQueue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pending</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> update</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_crNb clean-btn">Copy</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_pHHM" id="processupdatequeue">processUpdateQueue<a class="hash-link" href="#processupdatequeue" title="Direct link to heading">â€‹</a></h3><p>åœ¨ beginWork é˜¶æ®µï¼Œä¼šè¿›è¡Œæ›´æ–°é˜Ÿåˆ—çš„å¤„ç†ã€‚</p><ol><li><p>æ•´ç† UpdateQueue ï¼Œå½“è¿›è¡Œäº†ä¸€æ¬¡æ›´æ–°åï¼Œæœ‰äº› Update å¯èƒ½è¢«è·³è¿‡äº†ï¼Œç¬¬äºŒæ¬¡æ›´æ–°åˆè¿›æ¥äº†æ–°çš„ Updateï¼Œæ­¤æ—¶å¯èƒ½å­˜åœ¨ä¸¤æ¡æ›´æ–°é˜Ÿåˆ—ï¼š1: ä¸Šä¸€æ¬¡è¢«è·³è¿‡çš„æ›´æ–°ï¼šfirstBaseUpdate - lastBaseUpdateï¼Œ 2: æ–°æ¥çš„ Update</p></li><li><p>æ–­å¼€ pending ç¯å½¢é“¾è¡¨ï¼Œåˆå¹¶ä¸Šé¢ä¸¤æ¡æ›´æ–°é˜Ÿåˆ—ï¼Œå› ä¸ºå½“å‰æ“ä½œçš„æ˜¯ WIP fiberï¼Œæ‰€ä»¥è¿˜éœ€è¦åŒæ­¥åˆ°  currrent fiber ä¸Šã€‚ï¼ˆä¸¤è¾¹éƒ½åŒæ­¥æ˜¯å› ä¸ºï¼Œå¦‚æœå½“å‰è¢«é«˜ä¼˜å…ˆçº§ä»»åŠ¡æ‰“æ–­ï¼ŒWIP å°±æ²¡æœ‰äº†ï¼Œä½†æ˜¯ current ä¸Šè¿˜ä¿ç•™ç€ï¼Œé¿å…ä¸¢å¤± Updateã€‚ï¼‰</p></li></ol><ol start="3"><li>while å¾ªç¯<ul><li>å¦‚æœä¼˜å…ˆçº§ä¸å¤Ÿï¼Œé‚£ä¹ˆè·³è¿‡æ›´æ–°ï¼Œæ”¾åˆ° firstBaseUpdate ä¸Šã€‚</li><li>å¦‚æœä¼˜å…ˆçº§è¶³å¤Ÿï¼Œå¤„ç†æœ¬æ¬¡æ›´æ–° <code>getStateFromUpdate()</code>ï¼Œåˆ«å¿˜äº†ï¼Œæœ¬æ¬¡æ›´æ–°æ˜¯åŸºäºä¸Šä¸€æ¬¡æ›´æ–°çš„ (baseState / å¾ªç¯æ›´æ–°çš„ newState)<ul><li>callback æ˜¯ setState çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœæœ‰ callbackï¼Œå°±ä¼šæ”¾åˆ° effects é˜Ÿåˆ—ä¸­</li><li>update = update.next å›åˆ° ç¬¬ä¸‰æ­¥</li></ul></li></ul></li><li>æ ¹æ®ä¸Šé¢çš„è®¡ç®—ï¼Œæ›´æ–° UpdateQueue çš„ firstBaseUpdateã€ lastBaseUpdateï¼ŒworkInProgress çš„ lanesã€memoizedState</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_pHHM" id="functioncomponent">FunctionComponent<a class="hash-link" href="#functioncomponent" title="Direct link to heading">â€‹</a></h2><p>è§ <a href="/docs/advanced/react-deep/react-hooks">React Hooks</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/advanced/react-deep/diff"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">React diff ç®—æ³•</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/advanced/react-deep/scheduler"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">React è°ƒåº¦å™¨</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_fIBx thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#æ›´æ–°ä¼˜å…ˆçº§" class="table-of-contents__link toc-highlight">æ›´æ–°ä¼˜å…ˆçº§</a><ul><li><a href="#updatequeue" class="table-of-contents__link toc-highlight">UpdateQueue</a></li><li><a href="#ä¼˜å…ˆé¡ºåºprioritization" class="table-of-contents__link toc-highlight">ä¼˜å…ˆé¡ºåºï¼ˆPrioritizationï¼‰</a></li></ul></li><li><a href="#æ•°æ®ç»“æ„" class="table-of-contents__link toc-highlight">æ•°æ®ç»“æ„</a></li><li><a href="#classcomponent--hostroot" class="table-of-contents__link toc-highlight">ClassComponent / HostRoot</a><ul><li><a href="#createupdate" class="table-of-contents__link toc-highlight">createUpdate</a></li><li><a href="#enqueueupdate" class="table-of-contents__link toc-highlight">enqueueUpdate</a></li><li><a href="#processupdatequeue" class="table-of-contents__link toc-highlight">processUpdateQueue</a></li></ul></li><li><a href="#functioncomponent" class="table-of-contents__link toc-highlight">FunctionComponent</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/note/daily/2022">æ—¥å¸¸ç¬”è®°</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/advanced">å‰ç«¯è¿›é˜¶</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/wsj_simonwong" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QIpu"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.wangsijie.top/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>å“å‘¦ï¼Œä½ æ¥å•¦<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QIpu"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/simonwong" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QIpu"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2019-2022 Simon Wong.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c6785169.js"></script>
<script src="/assets/js/main.608fd00c.js"></script>
</body>
</html>