(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{402:function(t,s,a){"use strict";a.r(s);var n=a(27),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"浏览器中的页面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器中的页面"}},[t._v("#")]),t._v(" 浏览器中的页面")]),t._v(" "),a("h2",{attrs:{id:"chrome-开发者工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#chrome-开发者工具"}},[t._v("#")]),t._v(" Chrome 开发者工具")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Elements")]),t._v(" "),a("td",[t._v("可以查看DOM结构、编辑CSS样式,用于测试页面布局和设计页面。")])]),t._v(" "),a("tr",[a("td",[t._v("Console")]),t._v(" "),a("td",[t._v("可以看成是 javascript Shell,能执行 Javascript脚本。通过 Console还能和页面中的 javascript对象交互。")])]),t._v(" "),a("tr",[a("td",[t._v("Source")]),t._v(" "),a("td",[t._v("1. 查看Wcb应用加载的所有文件"),a("br"),t._v("2. 编辑CSS和 Javascript文件内容"),a("br"),t._v("3. 将打乱的CSS文件或者 Javascript文件格式化;"),a("br"),t._v("4. 支持 Javascript的调试功能"),a("br"),t._v("5. 设置工作区,将更改的文件保存到本地文件夹中。")])]),t._v(" "),a("tr",[a("td",[t._v("NetWork")]),t._v(" "),a("td",[t._v("展示了页面中所有的请求内容列表、能查看每项请求的请求行、请求头、请求体、时间线以及网络请求瀑布图等信息。")])]),t._v(" "),a("tr",[a("td",[t._v("Performance")]),t._v(" "),a("td",[t._v("记录和查看Wcb应用生命周期内的各种事件,并用来分析在执行过程中一些影响性能的要点。")])]),t._v(" "),a("tr",[a("td",[t._v("Memory")]),t._v(" "),a("td",[t._v("用来查看运行过程中的 Javascript 占用堆内存情况,追踪是否存在内存泄的情况等。")])]),t._v(" "),a("tr",[a("td",[t._v("Application")]),t._v(" "),a("td",[t._v("查看Wcb应用的数据存储情况"),a("br"),t._v("PWA的基础数据; Indexeddb; Web SQL;本地和会话存储: Cookie;应用程序缓存;图像;字体和样式表等。")])]),t._v(" "),a("tr",[a("td",[t._v("Security")]),t._v(" "),a("td",[t._v("显示当前页面一些基础的安全信息。")])]),t._v(" "),a("tr",[a("td",[t._v("Audits")]),t._v(" "),a("td",[t._v("会对当前网页进行网络利用情况、网页性能方面的诊断,并给出一些优化建议。")])]),t._v(" "),a("tr",[a("td",[t._v("Layers")]),t._v(" "),a("td",[t._v("展示一些渲染过程中分层的基础信息。")])])])]),t._v(" "),a("h3",{attrs:{id:"network"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#network"}},[t._v("#")]),t._v(" NetWork")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://file.wangsijie.top/blog/20210618141751.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"dom-树"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dom-树"}},[t._v("#")]),t._v(" DOM 树")]),t._v(" "),a("p",[t._v("在渲染引擎内部，有一个叫**HTML解析器（HTMLParser）**的模块，负责将HTML字节流转换为DOM结构。")]),t._v(" "),a("p",[t._v("HTML 文档边加载边解析。")]),t._v(" "),a("p",[a("strong",[t._v("碰到 script 标签时，会先去执行 js ，js 文件下载也会阻塞 DOM 的解析。")])]),t._v(" "),a("p",[t._v("script "),a("code",[t._v("async")]),t._v(" 下载完后会立即执行，"),a("code",[t._v("defer")]),t._v(" 会在文档解析后，"),a("code",[t._v("DOMContentLoaded")]),t._v(" 前执行，所以会阻塞 "),a("code",[t._v("DOMContentLoaded")])]),t._v(" "),a("p",[t._v("样式文件会阻塞 css 文件。")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" div1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    div1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerText "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'time.geekbang'")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" div2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    div2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerText "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'time.geekbang.com'")]),t._v("\n    ")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("test"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h2",{attrs:{id:"渲染流水线"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#渲染流水线"}},[t._v("#")]),t._v(" 渲染流水线")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://file.wangsijie.top/blog/20210618161044.png",alt:""}})]),t._v(" "),a("p",[t._v("通常情况下的瓶颈主要体现在"),a("strong",[t._v("下载CSS文件、下载JavaScript文件和执行JavaScript")])]),t._v(" "),a("p",[t._v("优化策略")]),t._v(" "),a("ul",[a("li",[t._v("通过内联JavaScript、内联CSS来移除这两种类型的文件下载，这样获取到HTML文件之后就可以直接开始渲染流程了。")]),t._v(" "),a("li",[t._v("但并不是所有的场合都适合内联，那么还可以尽量减少文件大小，比如通过webpack等工具移除一些不必要的注释，并压缩JavaScript文件。")]),t._v(" "),a("li",[t._v("还可以将一些不需要在解析HTML阶段使用的JavaScript标记上async或者defer。")]),t._v(" "),a("li",[t._v("对于大的CSS文件，可以通过媒体查询属性，将其拆分为多个不同用途的CSS文件，这样只有在特定的场景下才会加载特定的CSS文件。")])]),t._v(" "),a("h2",{attrs:{id:"分层和合成机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分层和合成机制"}},[t._v("#")]),t._v(" 分层和合成机制")]),t._v(" "),a("h2",{attrs:{id:"页面性能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#页面性能"}},[t._v("#")]),t._v(" 页面性能")]),t._v(" "),a("h3",{attrs:{id:"加载阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#加载阶段"}},[t._v("#")]),t._v(" 加载阶段")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://file.wangsijie.top/blog/20210621095343.jpg",alt:""}})]),t._v(" "),a("p",[a("strong",[t._v("总的优化原则就是减少关键资源个数，降低关键资源大小，降低关键资源的RTT次数")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"交互阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#交互阶段"}},[t._v("#")]),t._v(" 交互阶段")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("减少 JS 执行时间")])]),t._v(" "),a("li",[a("p",[t._v("避免强制同步布局")]),t._v(" "),a("p",[t._v("由于要获取到offsetHeight，但是此时的offsetHeight还是老的数据，所以需要立即执行布局操作")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" main_div"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" new_node "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 省略........")]),t._v("\n  document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mian_div"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("new_node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("main_div"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetHeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])]),t._v(" "),a("p",[t._v("改成如下")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" main_div "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 省略........")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("main_div"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetHeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" new_node "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 省略........ ")]),t._v("\n    document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mian_div"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("new_node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[t._v("避免布局抖动")]),t._v(" "),a("p",[t._v("指在一次JavaScript执行过程中，多次执行强制布局和抖动操作")])]),t._v(" "),a("li",[a("p",[t._v("合理利用 CSS 合成动画，能让 css 处理动画尽量让 css 处理")])]),t._v(" "),a("li",[a("p",[t._v("避免频繁的垃圾回收")])])]),t._v(" "),a("h2",{attrs:{id:"虚拟-dom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟-dom"}},[t._v("#")]),t._v(" 虚拟 DOM")]),t._v(" "),a("h3",{attrs:{id:"dom-的缺陷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dom-的缺陷"}},[t._v("#")]),t._v(" DOM 的缺陷")]),t._v(" "),a("p",[t._v("利用类似 "),a("code",[t._v("document.body.appendChild(node)")]),t._v(" 会触发重排。\n不当的 DOM 操作还会引起强制同步布局和布局抖动。")]),t._v(" "),a("h3",{attrs:{id:"虚拟-dom-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟-dom-2"}},[t._v("#")]),t._v(" 虚拟 DOM")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("双缓存")]),t._v(" "),a("p",[t._v("将计算的中间结果放到一个缓冲区，等全部计算完后一次性复制到显示缓冲区")])]),t._v(" "),a("li",[a("p",[t._v("MVC 模式")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://file.wangsijie.top/blog/20210621102719.png",alt:""}})])])]),t._v(" "),a("h2",{attrs:{id:"渐进式网页应用-pwa"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#渐进式网页应用-pwa"}},[t._v("#")]),t._v(" 渐进式网页应用 PWA")]),t._v(" "),a("p",[t._v("Progressive Web App， 字面意思就是“渐进式 + web应用”")]),t._v(" "),a("p",[a("strong",[t._v("渐进式增强Web的优势，并通过技术手段渐进式缩短和本地应用或者小程序的距离")])]),t._v(" "),a("h3",{attrs:{id:"web-应用-vs-本地应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-应用-vs-本地应用"}},[t._v("#")]),t._v(" web 应用 vs 本地应用")]),t._v(" "),a("ul",[a("li",[t._v("web 应用缺少离线使用能力，离线或弱网几乎无法使用")]),t._v(" "),a("li",[t._v("web 应用缺少消息推送能力")]),t._v(" "),a("li",[t._v("web 应用缺少一级入口")])]),t._v(" "),a("p",[t._v("PWA 提供了两种解决方案")]),t._v(" "),a("ul",[a("li",[t._v("引入 service worker 解决离线和推送问题")]),t._v(" "),a("li",[t._v("引入 mainfest.json 解决一级入口问题")])]),t._v(" "),a("h3",{attrs:{id:"service-worker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service-worker"}},[t._v("#")]),t._v(" Service Worker")]),t._v(" "),a("p",[t._v("主要思想是"),a("strong",[t._v("在页面和网络之间增加一个拦截器，用来缓存和拦截请求")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://file.wangsijie.top/blog/20210621103739.png",alt:""}})]),t._v(" "),a("ul",[a("li",[t._v("架构：Service Worker是运行在浏览器进程中的")]),t._v(" "),a("li",[t._v("消息推送：也是基于Service Worker来实现的")]),t._v(" "),a("li",[t._v("安全：要使站点支持Service Worker，首先必要的一步就是要将站点升级到HTTPS")])]),t._v(" "),a("h2",{attrs:{id:"webcomponent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webcomponent"}},[t._v("#")]),t._v(" WebComponent")]),t._v(" "),a("p",[t._v("WebComponent是一套技术的组合，具体涉及到了**Custom elements（自定义元素）、Shadow DOM（影子DOM）*"),a("em",[t._v("和*"),a("em",[t._v("HTML templates（HTML模板）")])])]),t._v(" "),a("ol",[a("li",[t._v("查找模板内容；")]),t._v(" "),a("li",[t._v("创建影子DOM；")]),t._v(" "),a("li",[t._v("再将模板添加到影子DOM上。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);