(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{420:function(s,t,a){"use strict";a.r(t);var e=a(27),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker-上各种镜像的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-上各种镜像的使用"}},[s._v("#")]),s._v(" Docker 上各种镜像的使用")]),s._v(" "),a("h2",{attrs:{id:"jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins"}},[s._v("#")]),s._v(" Jenkins")]),s._v(" "),a("p",[s._v("Jenkins 官方推荐的镜像  "),a("code",[s._v("jenkinsci/blueocean")]),s._v(" 里面捆绑了所有的blueocean")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ docker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u root \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p 8999:8080 \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p 50000:50000 \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("jenkins_home:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("jenkins_home \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("run"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sock:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("run"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sock \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name jenkins \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("restart=always \\\njenkinsci"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("blueocean\n")])])]),a("p",[a("code",[s._v("-v")]),s._v(" 除了分配 jenkins 的工作目录，还分配了 docker 提供给 容器使用")]),s._v(" "),a("p",[s._v("访问容器")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ docker exec "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it jenkins bash\n")])])]),a("h3",{attrs:{id:"初始化配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化配置"}},[s._v("#")]),s._v(" 初始化配置")]),s._v(" "),a("p",[s._v("拿到初始密码")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ docker logs jenkins\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("jenkins_home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("secrets"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("initialAdminPassword\n")])])]),a("p",[s._v("到你的外网 "),a("code",[s._v("x.x.x.x:8999")]),s._v(" （可能需要配置你云服务器的防火墙）输入初始密码，配置管理员用户，安装插件")]),s._v(" "),a("h3",{attrs:{id:"ssh-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh-配置"}},[s._v("#")]),s._v(" SSH 配置")]),s._v(" "),a("p",[s._v("进入到容器后")]),s._v(" "),a("ol",[a("li",[s._v("生成 ssh")])]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ ssh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("keygen "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("t rsa "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("C "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wsj_simon@163.com"')]),s._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("复制到宿主机")])]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ docker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" jenkins:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ssh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("id_rsa"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pub ~"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ssh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n\n$ cd ~"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ssh\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" id_rsa"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pub >> authorized_keys\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("重启 ssh 服务")])]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ systemctl restart sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("service\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("GitHub ssh 配置")])]),s._v(" "),a("p",[s._v("settings/SSH and GPG keys/New SSH key 新增一个 ssh key")]),s._v(" "),a("p",[s._v("PS :  配置了 ssh 之后也许还是不行，"),a("code",[s._v("jenkins The authenticity of host 'github.com (13.250.177.223)' can't be established.")]),s._v(" 或者 "),a("code",[s._v("Authentication failed")]),s._v(" 等等")]),s._v(" "),a("p",[s._v("有三种解决方法：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("~/.ssh/known_hosts 文件添加公钥 ，如下")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("github.com,13.250.177.223 ssh-rsa AAAxxxxx....\n")])])])]),s._v(" "),a("li",[a("p",[s._v("进入到容器中，使用 "),a("code",[s._v("git clone xxxx")]),s._v("时会显示 "),a("code",[s._v("Are you sure you want to continue connecting (yes/no)?")]),s._v(" yes ，就可以会自动添加了")])]),s._v(" "),a("li",[a("p",[s._v("全局凭据配置，范围（scope）选择:"),a("code",[s._v("全局 (Jenkins, nodes, items, all child items, etc)")]),s._v(" ,类型（kind）选择："),a("code",[s._v("SSH Username with private key")]),s._v(" 。填写 username（随便填），private key 从 "),a("code",[s._v("~/.ssh/id_rsa")]),s._v(" 的内容复制。然后配置 Credentials 时，选择 这个凭据。")])])]),s._v(" "),a("h3",{attrs:{id:"使用域名访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用域名访问"}},[s._v("#")]),s._v(" 使用域名访问")]),s._v(" "),a("p",[s._v("可以用nginx 反向代理到 jk 的端口")]),s._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v("                  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8998")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v("             myjenkins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_pass")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("http")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8999")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"其他问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他问题"}},[s._v("#")]),s._v(" 其他问题")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("时间不对")]),s._v(" "),a("p",[s._v("【系统管理】=> 【脚本命令运行】")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("System.setProperty('org.apache.commons.jelly.tags.fmt.timeZone', 'Asia/Shanghai')\n")])])])])]),s._v(" "),a("h2",{attrs:{id:"mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql"}},[s._v("#")]),s._v(" MySql")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ docker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name mysql \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("e MYSQL_ROOT_PASSWORD=123456 \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p 3306:3306 \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("restart=always \\\nmysql\n")])])]),a("p",[a("code",[s._v("-e MYSQL_ROOT_PASSWORD=123456")]),s._v(" 设置 root 用户密码")]),s._v(" "),a("p",[a("code",[s._v("-d")]),s._v(" 后台运行")]),s._v(" "),a("p",[a("code",[s._v("-p 3306:3306")]),s._v(" 指定端口")]),s._v(" "),a("p",[a("code",[s._v("--restart=always")]),s._v(" docker 重启后，容器自动启动")]),s._v(" "),a("p",[a("code",[s._v("--privileged=true")]),s._v(" 容器内的root拥有真正root权限，否则容器内root只是外部普通用户权限")]),s._v(" "),a("p",[a("code",[s._v("-v")]),s._v(" 挂在目录")]),s._v(" "),a("p",[s._v("mysql 的默认配置文件"),a("code",[s._v("/etc/mysql/my.cnf")]),s._v(" "),a("code",[s._v("/etc/mysql/conf.d")]),s._v("  后者是个文件夹，权限大于前者。文件夹中可以命名任意 "),a("code",[s._v("xxx.cnf")]),s._v(" 来覆盖 "),a("code",[s._v("my.cnf")])]),s._v(" "),a("p",[s._v("Mysql 的数据默认存放在 "),a("code",[s._v("/var/lib/mysql")]),s._v(" 中")]),s._v(" "),a("p",[s._v("进入")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器")]),s._v("\n$ docker exec "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it mysql bash\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 登陆输入上面的密码")]),s._v("\n$ mysql "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p\n")])])]),a("h3",{attrs:{id:"远程访问权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#远程访问权限"}},[s._v("#")]),s._v(" 远程访问权限")]),s._v(" "),a("p",[s._v("这里需要有个用户的概念。root 用户没有开放远程访问权限。而是另外创建了一个 simon 用户，授予远程访问。")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加进入到mysql容器内部才能执行命令设置远程登陆账号密码")]),s._v("\n$ CREATE USER "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'simon'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" IDENTIFIED WITH mysql_native_password BY "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启远程访问权限")]),s._v("\n$ GRANT ALL PRIVILEGES ON "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" TO "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'simon'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 刷新权限")]),s._v("\n$ flush privileges"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    \n")])])]),a("p",[s._v("配置 conf 文件使得外部可以连接，记得开放防火墙")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[mysqld]\n\nbind-address = 0.0.0.0\n")])])]),a("h2",{attrs:{id:"mongodb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb"}},[s._v("#")]),s._v(" MongoDB")]),s._v(" "),a("h3",{attrs:{id:"运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行"}},[s._v("#")]),s._v(" 运行")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ docker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name mongo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p 27017:27017 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mongo"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mongo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mongo"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("db "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("restart=always mongo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("auth "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("config "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mongo"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mongod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n")])])]),a("p",[s._v("docker run --name mongo -d -p 27017:27017 mongo --auth")]),s._v(" "),a("p",[s._v("mongo 配置")]),s._v(" "),a("p",[a("code",[s._v("--auth")]),s._v(" 需要密码才能访问容器服务")]),s._v(" "),a("p",[s._v("Mongoldb 的默认配置文件"),a("code",[s._v("/etc/mongo/mongod.conf")])]),s._v(" "),a("p",[s._v("Mongoldb 的数据默认存放在 "),a("code",[s._v("/data/db")]),s._v(" 中")]),s._v(" "),a("h3",{attrs:{id:"进入与用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进入与用户"}},[s._v("#")]),s._v(" 进入与用户")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("docker exec "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it mongo mongo admin\n")])])]),a("p",[s._v("以admin 的身份登陆 mongo")]),s._v(" "),a("p",[s._v("创建 admin")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("createUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" user:"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'admin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pwd")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("roles:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" role:"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" db: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'admin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("使用用户登陆")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("auth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'admin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("p",[s._v("指定某个数据库的用户权限")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("use test\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("createUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tuser: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'testUser'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pwd")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'testPwd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\troles: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'readWrited'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("h3",{attrs:{id:"远程连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#远程连接"}},[s._v("#")]),s._v(" 远程连接")]),s._v(" "),a("p",[s._v("配置 conf 文件使得外部可以连接。好像不配置也可以，但是记得配置防火墙")]),s._v(" "),a("div",{staticClass:"language-conf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("net:\n   bindIp: 0.0.0.0\n   port: 27017\n")])])]),a("h2",{attrs:{id:"redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis"}},[s._v("#")]),s._v(" Redis")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ docker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name redis "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p 6379:6379 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("restart=always redis redis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("server "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("appendonly yes\n")])])]),a("p",[a("code",[s._v("redis-server xx.conf --appendonly yes")])]),s._v(" "),a("p",[s._v("启动 redis 服务器，")]),s._v(" "),a("p",[s._v("xx.conf 指定配置文件，")]),s._v(" "),a("p",[s._v("appendonly 打开Redis持久化配置。")]),s._v(" "),a("p",[s._v("Redis 默认配置文件下载 http://download.redis.io/releases/")]),s._v(" "),a("p",[s._v("Redis 的默认配置文件 "),a("code",[s._v("/usr/local/etc/redis/redis.conf")])]),s._v(" "),a("p",[s._v("Redis 的数据默认存放在 "),a("code",[s._v("/data")])]),s._v(" "),a("p",[s._v("设置 conf 文件下的 "),a("code",[s._v("requirepass yourpassword")])]),s._v(" "),a("h3",{attrs:{id:"进入容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进入容器"}},[s._v("#")]),s._v(" 进入容器")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 redis-cli")]),s._v("\n$ docker exec "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it redis redis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cli")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取权限操作")]),s._v("\n$ auth yourpassword\n")])])]),a("h3",{attrs:{id:"远程连接-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#远程连接-2"}},[s._v("#")]),s._v(" 远程连接")]),s._v(" "),a("p",[s._v("可以下载客户端 "),a("a",{attrs:{href:"https://github.com/qishibo/AnotherRedisDesktopManager",target:"_blank",rel:"noopener noreferrer"}},[s._v("AnotherRedisDesktopManager"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("远程连接需要修改conf文件。我这里只修改了 bind 就可以，如果不可以再添加 protected-mode")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("daemonize no\nbind 0.0.0.0\nprotected-mode no\n")])])]),a("p",[a("code",[s._v("daemonize no")]),s._v(" 在Docker中后台启动一个镜像，当前台无响应时会自动退出。Redis 进程被后台化后， 启动Redis的那个进程，也就是Docker执行进程无事可做，因此Docker执行进程退出。当然如果你的Redis的配置文件中没有后台运行，就不会出现这种状况。将Redis的后台运行改为"),a("code",[s._v("no")]),s._v("，这样就完成了。")]),s._v(" "),a("h2",{attrs:{id:"nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[s._v("#")]),s._v(" nginx")]),s._v(" "),a("p",[a("code",[s._v("nginx:alpine")]),s._v(" 版本")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ docker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name nginx_center \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p 80:80 \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p 443:443 \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ssl:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ssl \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("restart=always \\\nnginx:alpine\n")])])]),a("p",[s._v("html 默认位置在 "),a("code",[s._v("/usr/share/nginx/html")])]),s._v(" "),a("p",[s._v("Log 默认位置在 "),a("code",[s._v("/var/log/nginx")])]),s._v(" "),a("p",[s._v("默认使用 "),a("code",[s._v("/etc/nginx/conf.d/default.conf")])]),s._v(" "),a("h2",{attrs:{id:"elasticsearch-集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-集群"}},[s._v("#")]),s._v(" Elasticsearch 集群")]),s._v(" "),a("p",[s._v("修改系统设置 "),a("code",[s._v("/etc/sysctl.conf")])]),s._v(" "),a("div",{staticClass:"language-conf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vm.max_map_count=262144\n#...\n")])])]),a("p",[s._v("执行 "),a("code",[s._v("sysctl -p")]),s._v(" 来使得配置生效")]),s._v(" "),a("p",[s._v("参考 https://www.elastic.co/guide/en/elastic-stack-get-started/current/get-started-docker.html")]),s._v(" "),a("p",[s._v("配置文件 es/docker-compose.yml")]),s._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("es01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" elasticsearch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("7.9.1\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yueqing_es01\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" node.name=es01\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" cluster.name=es"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("cluster\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" network.bind_host=0.0.0.0\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" discovery.seed_hosts=es02\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" cluster.initial_master_nodes=es01"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("es02\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" bootstrap.memory_lock=true\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ES_JAVA_OPTS=-Xms512m -Xmx512m"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ulimits")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("soft")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("-1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hard")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("-1")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" data01"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/usr/share/elasticsearch/data\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 9200"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" elastic\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("es02")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" elasticsearch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("7.9.1\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yueqing_es02\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" node.name=es02\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" cluster.name=es"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("cluster\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" network.bind_host=0.0.0.0\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" discovery.seed_hosts=es01\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" cluster.initial_master_nodes=es01"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("es02\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" bootstrap.memory_lock=true\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ES_JAVA_OPTS=-Xms512m -Xmx512m"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ulimits")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("soft")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("-1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hard")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("-1")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" data02"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/usr/share/elasticsearch/data\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" elastic\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kibana")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kibana"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("7.9.1\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yueqing_kibana\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 5601"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5601")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("I18N_LOCALE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" zh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("CN\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ELASTICSEARCH_URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//es01"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ELASTICSEARCH_HOSTS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//es01"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# volumes:")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - ./kibana.yml:/usr/share/kibana/config/kibana.yml")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" elastic\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("data01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" local\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("data02")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" local\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("elastic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("external")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" bridge\n\n")])])]),a("p",[s._v("执行 "),a("code",[s._v("docker-compose up -d")]),s._v(" 启动集群")])])}),[],!1,null,null,null);t.default=r.exports}}]);